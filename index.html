<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>To-Do List</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>To Do List</h1>
    <div class="input-section">
      <input type="text" id="taskInput" placeholder="Введите задачу">
      <button id="addTaskBtn">Добавить</button>
    </div>

    <!--  Фильтр задач -->
    <div class="filter-section">
      <button id="filterAll" class="filter-btn active">Все</button>
      <button id="filterCompleted" class="filter-btn">Выполненные</button>
      <button id="filterUncompleted" class="filter-btn">Невыполненные</button>
    </div>

    <ul id="taskList"></ul>
  </div>

  <script>
    const taskInput = document.getElementById("taskInput");
    const addTaskBtn = document.getElementById("addTaskBtn");
    const taskList = document.getElementById("taskList");

    const filterAll = document.getElementById("filterAll");
    const filterCompleted = document.getElementById("filterCompleted");
    const filterUncompleted = document.getElementById("filterUncompleted");

    //  Добавление задачи
    function addTask() {
      const taskText = taskInput.value.trim();
      if (taskText === "") return;

      const li = document.createElement("li");
      li.textContent = taskText;

      // Кнопка удаления
      const deleteBtn = document.createElement("button");
      deleteBtn.textContent = "Удалить";
      deleteBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        li.remove();
        saveTasks();
      });

      // Отметка выполнения
      li.addEventListener("click", () => {
        li.classList.toggle("completed");
        saveTasks();
      });

      li.appendChild(deleteBtn);
      taskList.appendChild(li);

      taskInput.value = "";
      saveTasks();
    }

    addTaskBtn.addEventListener("click", addTask);
    taskInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") addTask();
    });

    //  Сохранение задач в localStorage
    function saveTasks() {
      const tasks = [];
      taskList.querySelectorAll("li").forEach((li) => {
        tasks.push({
          text: li.firstChild.textContent,
          completed: li.classList.contains("completed"),
        });
      });
      localStorage.setItem("tasks", JSON.stringify(tasks));
    }

    //  Загрузка задач из localStorage
    function loadTasks() {
      const savedTasks = JSON.parse(localStorage.getItem("tasks")) || [];
      savedTasks.forEach((task) => {
        const li = document.createElement("li");
        li.textContent = task.text;

        if (task.completed) li.classList.add("completed");

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "Удалить";
        deleteBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          li.remove();
          saveTasks();
        });

        li.addEventListener("click", () => {
          li.classList.toggle("completed");
          saveTasks();
        });

        li.appendChild(deleteBtn);
        taskList.appendChild(li);
      });
    }

    loadTasks();

    //  Фильтрация задач
    function filterTasks(filter) {
      const tasks = taskList.querySelectorAll("li");
      tasks.forEach((task) => {
        switch (filter) {
          case "all":
            task.style.display = "flex";
            break;
          case "completed":
            task.style.display = task.classList.contains("completed") ? "flex" : "none";
            break;
          case "uncompleted":
            task.style.display = !task.classList.contains("completed") ? "flex" : "none";
            break;
        }
      });
    }

    filterAll.addEventListener("click", () => filterTasks("all"));
    filterCompleted.addEventListener("click", () => filterTasks("completed"));
    filterUncompleted.addEventListener("click", () => filterTasks("uncompleted"));
  </script>
</body>
</html>
